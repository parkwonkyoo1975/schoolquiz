<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•™êµ ê·œì¹™ ëœë¤ í€´ì¦ˆ</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #4a90e2; --success: #2ecc71; --danger: #e74c3c; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Noto Sans KR', sans-serif; }
        body { background: #f0f2f5; display: flex; justify-content: center; padding: 20px; }
        .container { max-width: 600px; width: 100%; background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .header { background: var(--primary); color: white; padding: 25px; text-align: center; }
        .content { padding: 25px; }
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; margin-bottom: 5px; font-weight: bold; }
        .input-group input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; }
        .quiz-section { display: none; }
        .question-card { background: #fff; border: 1px solid #eee; padding: 20px; border-radius: 12px; margin-bottom: 20px; }
        .option { display: block; padding: 12px; border: 2px solid #eee; border-radius: 8px; margin-top: 10px; cursor: pointer; transition: 0.2s; }
        .option.correct { background: #d4edda; border-color: var(--success); color: #155724; }
        .option.wrong { background: #f8d7da; border-color: var(--danger); color: #721c24; }
        .option.disabled { pointer-events: none; opacity: 0.7; }
        .feedback-msg { margin-top: 10px; font-weight: bold; display: none; }
        .btn { width: 100%; padding: 15px; background: var(--primary); color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; margin-top: 10px; }
        .btn:disabled { background: #ccc; cursor: not-allowed; }
        .result-screen { display: none; text-align: center; padding: 40px 20px; }
        .score-big { font-size: 60px; font-weight: bold; color: var(--primary); }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>ğŸ« í•™êµ ê·œì¹™ ëœë¤ í€´ì¦ˆ</h1>
        <p>10ë¬¸ì œ ëª¨ë‘ ë§í˜€ì•¼ í†µê³¼!</p>
    </div>

    <div class="content">
        <div id="infoSection">
            <div class="input-group"><label>í•™ë…„</label><input type="number" id="grade" placeholder="ì˜ˆ: 3"></div>
            <div class="input-group"><label>ë°˜</label><input type="number" id="classNum" placeholder="ì˜ˆ: 1"></div>
            <div class="input-group"><label>ë²ˆí˜¸</label><input type="number" id="number" placeholder="ì˜ˆ: 15"></div>
            <div class="input-group"><label>ì´ë¦„</label><input type="text" id="name" placeholder="ì´ë¦„ ì…ë ¥"></div>
            <button class="btn" onclick="startQuiz()">í€´ì¦ˆ ì‹œì‘í•˜ê¸°</button>
        </div>

        <div id="quizSection" class="quiz-section">
            <div id="questionsContainer"></div>
            <button id="submitBtn" class="btn" onclick="finishQuiz()" disabled>ê²°ê³¼ ì œì¶œí•˜ê¸°</button>
        </div>

        <div id="resultSection" class="result-screen">
            <h2 id="resultTitle"></h2>
            <div class="score-big" id="finalScore">0/10</div>
            <p id="resultMsg" style="margin: 20px 0;"></p>
            <button class="btn" onclick="location.reload()">ë‹¤ì‹œ ë„ì „í•˜ê¸°</button>
        </div>
    </div>
</div>

<script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycbxFcOp-kkaqIj4NYkW8IrvK0EX9sXp2X-EMzgmOrXmPtL8CJVBdwWliG61FGdOagvrrGQ/exec"; 
    
    // 15ë¬¸ì œ ë¬¸ì œì€í–‰ (ì´ ì¤‘ 10ê°œê°€ ëœë¤ ì„ íƒë¨)
    const itemBank = [
        { q: "ì •í•´ì§„ ë“±êµ ì‹œê°„ì€ ì–¸ì œì¸ê°€ìš”?", a: ["ì‹œê°„ ì—„ìˆ˜", "ì•„ë¬´ ë•Œë‚˜", "ì¹œêµ¬ ì˜¬ ë•Œ", "ìˆ˜ì—… ë„ì¤‘"], cor: 0 },
        { q: "ë³µë„ì—ì„œ ì˜¬ë°”ë¥¸ ë³´í–‰ ë°©ë²•ì€?", a: ["ì „ë ¥ ì§ˆì£¼", "ìš°ì¸¡í†µí–‰í•˜ë©° ê±·ê¸°", "í° ì†Œë¦¬ë¡œ ë…¸ë˜", "ì¥ë‚œì¹˜ê¸°"], cor: 1 },
        { q: "ìˆ˜ì—… ì¤‘ í™”ì¥ì‹¤ì´ ê¸‰í•  ë•ŒëŠ”?", a: ["ëª°ë˜ ë‚˜ê°", "ì°¸ìŒ", "ì†ë“¤ê³  í—ˆë½ë°›ê¸°", "ì†Œë¦¬ ì§€ë¦„"], cor: 2 },
        { q: "ì¹œêµ¬ ë¬¼ê±´ì„ ë¹Œë¦´ ë•ŒëŠ”?", a: ["ëª°ë˜ ì”€", "ë¨¼ì € í—ˆë½ ë°›ê¸°", "ê·¸ëƒ¥ ê°€ì ¸ê°", "ë‚˜ì¤‘ì— ë§í•¨"], cor: 1 },
        { q: "ê¸‰ì‹ì‹¤ì—ì„œ ì§€í‚¬ ì˜ˆì ˆì€?", a: ["ìƒˆì¹˜ê¸°", "ì¤„ ì„œì„œ ê¸°ë‹¤ë¦¬ê¸°", "ìŒì‹ ë˜ì§€ê¸°", "ë– ë“¤ê¸°"], cor: 1 },
        { q: "êµì‹¤ ì“°ë ˆê¸°ëŠ” ì–´ë–»ê²Œ?", a: ["ì±…ìƒ ì†", "ë°”ë‹¥ì—", "ì“°ë ˆê¸°í†µì— ë°”ë¡œ", "ì°½ë°–ìœ¼ë¡œ"], cor: 2 },
        { q: "ì„ ìƒë‹˜ ë§ì”€í•˜ì‹¤ ë•Œ íƒœë„ëŠ”?", a: ["ë”´ì§“", "ê²½ì²­ ë° ì§‘ì¤‘", "ì ìê¸°", "ì¹œêµ¬ì™€ ëŒ€í™”"], cor: 1 },
        { q: "ì¹œêµ¬ê°€ ì‹¤ìˆ˜í–ˆì„ ë•Œ?", a: ["ë†€ë¦¼", "ë¹„ì›ƒìŒ", "ìœ„ë¡œì™€ ê²©ë ¤", "ë¬´ì‹œ"], cor: 2 },
        { q: "í•˜êµ ì‹œ í•  ì¼ì€?", a: ["ì£¼ë³€ ì •ë¦¬ ë° ì¸ì‚¬", "ê·¸ëƒ¥ ë„ë§", "ë¬¼ê±´ ë‘ê³  ê°€ê¸°", "ë³µë„ ì§ˆì£¼"], cor: 0 },
        { q: "êµì‹¤ ë¬¼ê±´ ì‚¬ìš© í›„?", a: ["ì œìë¦¬ì— ì •ë¦¬", "ë°”ë‹¥ì— ë‘ ", "ê°€ì ¸ê°", "ë§ê°€ëœ¨ë¦¼"], cor: 0 },
        { q: "ì‹¤ë‚´í™”ëŠ” ì–´ë””ì„œ ì‹ ë‚˜ìš”?", a: ["ìš´ë™ì¥", "êµì‹¤/ë³µë„", "ì§‘", "í™”ì¥ì‹¤ ë°–"], cor: 1 },
        { q: "ìˆ˜ì—… ì‹œì‘ì¢…ì´ ìš¸ë¦¬ë©´?", a: ["ê³„ì† ë…¼ë‹¤", "ìë¦¬ì— ì•‰ì•„ ì¤€ë¹„", "í™”ì¥ì‹¤ ê°„ë‹¤", "ë³µë„ë¡œ ë‚˜ê°„ë‹¤"], cor: 1 },
        { q: "ê¸‰ìš°ì™€ ë‹¤íˆ¼ì´ ìƒê¸°ë©´?", a: ["ë¨¼ì € ë•Œë¦°ë‹¤", "ìš•ì„ í•œë‹¤", "ì„ ìƒë‹˜ê»˜ ë„ì›€ ìš”ì²­", "ëê¹Œì§€ ì‹¸ìš´ë‹¤"], cor: 2 },
        { q: "êµì‹¤ì—ì„œ ë›°ë©´ ì•ˆ ë˜ëŠ” ì´ìœ ?", a: ["ì‹¬ì‹¬í•´ì„œ", "ì•ˆì „ ì‚¬ê³  ì˜ˆë°©", "ì„ ìƒë‹˜ì´ ì‹«ì–´í•´ì„œ", "ë‹¤ì´ì–´íŠ¸í•˜ë ¤ê³ "], cor: 1 },
        { q: "ë„ì„œì‹¤ì—ì„œ ì§€í‚¬ ì˜ˆì ˆì€?", a: ["í°ì†Œë¦¬ë¡œ ì½ê¸°", "ì¡°ìš©íˆ ë…ì„œí•˜ê¸°", "ì±…ì¥ì— ë‚™ì„œí•˜ê¸°", "ê°„ì‹ ë¨¹ê¸°"], cor: 1 }
    ];

    let selectedQuestions = [];
    let userAnswers = [];
    let score = 0;

    function startQuiz() {
        const fields = ['grade', 'classNum', 'number', 'name'];
        for(let f of fields) if(!document.getElementById(f).value) return alert("ì •ë³´ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        
        // ë¬¸ì œì€í–‰ì—ì„œ 10ê°œ ëœë¤ ì¶”ì¶œ
        selectedQuestions = itemBank.sort(() => 0.5 - Math.random()).slice(0, 10);
        userAnswers = new Array(10).fill(null);

        document.getElementById('infoSection').style.display = 'none';
        document.getElementById('quizSection').style.display = 'block';
        renderQuestions();
    }

    function renderQuestions() {
        const container = document.getElementById('questionsContainer');
        selectedQuestions.forEach((item, idx) => {
            let html = `<div class="question-card" id="q-card-${idx}">
                <p><strong>ë¬¸ì œ ${idx+1}. ${item.q}</strong></p>`;
            item.a.forEach((opt, optIdx) => {
                html += `<div class="option" id="opt-${idx}-${optIdx}" onclick="checkImmediate(${idx}, ${optIdx})">${opt}</div>`;
            });
            html += `<div id="fb-${idx}" class="feedback-msg"></div></div>`;
            container.innerHTML += html;
        });
    }

    function checkImmediate(qIdx, optIdx) {
        if (userAnswers[qIdx] !== null) return; // ì´ë¯¸ í‘¼ ë¬¸ì œëŠ” íŒ¨ìŠ¤

        userAnswers[qIdx] = optIdx;
        const correctIdx = selectedQuestions[qIdx].cor;
        const feedback = document.getElementById(`fb-${qIdx}`);
        feedback.style.display = "block";

        // ì •ë‹µ ì˜¤ë‹µ ì‹œê°í™”
        const options = document.querySelectorAll(`#q-card-${qIdx} .option`);
        options.forEach((opt, i) => {
            opt.classList.add('disabled');
            if (i === correctIdx) opt.classList.add('correct');
            else if (i === optIdx) opt.classList.add('wrong');
        });

        if (optIdx === correctIdx) {
            score++;
            feedback.innerHTML = "âœ… ì •ë‹µì…ë‹ˆë‹¤!";
            feedback.style.color = "var(--success)";
        } else {
            feedback.innerHTML = `âŒ í‹€ë ¸ìŠµë‹ˆë‹¤. ì •ë‹µì€ [${selectedQuestions[qIdx].a[correctIdx]}] ì…ë‹ˆë‹¤.`;
            feedback.style.color = "var(--danger)";
        }

        // ëª¨ë“  ë¬¸ì œë¥¼ í’€ì—ˆì„ ë•Œë§Œ ì œì¶œ ë²„íŠ¼ í™œì„±í™”
        const answeredCount = userAnswers.filter(ans => ans !== null).length;
        if (answeredCount === 10) document.getElementById('submitBtn').disabled = false;
    }

    async function finishQuiz() {
        const data = {
            grade: document.getElementById('grade').value,
            classNum: document.getElementById('classNum').value,
            number: document.getElementById('number').value,
            name: document.getElementById('name').value,
            score: score
        };

        const submitBtn = document.getElementById('submitBtn');
        submitBtn.disabled = true;
        submitBtn.textContent = "ì €ì¥ ì¤‘...";

        try {
            await fetch(GAS_URL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(data) });
        } catch(e) { console.log(e); }

        showResult();
    }

    function showResult() {
        document.getElementById('quizSection').style.display = 'none';
        document.getElementById('resultSection').style.display = 'block';
        window.scrollTo(0,0);
        
        document.getElementById('finalScore').textContent = score + "/10";
        if(score === 10) {
            document.getElementById('resultTitle').textContent = "ğŸ‰ ì™„ë²½í•´ìš”! í†µê³¼!";
            document.getElementById('resultMsg').textContent = "ëª¨ë“  ê·œì¹™ì„ ë‹¤ ë§í˜”ìŠµë‹ˆë‹¤. í›Œë¥­í•©ë‹ˆë‹¤!";
        } else {
            document.getElementById('resultTitle').textContent = "âŒ ì•„ì‰¬ì›Œìš”! ë¶ˆí•©ê²©";
            document.getElementById('resultMsg').textContent = "10ì  ë§Œì ì„ ë°›ì•„ì•¼ í†µê³¼ì…ë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”!";
        }
    }
</script>
</body>
</html>
